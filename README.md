<img width="1182" height="433" alt="dwn" src="https://github.com/user-attachments/assets/e9136853-4987-476e-a531-9fb62e7619d5" /><img width="1182" height="433" alt="dwn" src="https://github.com/user-attachments/assets/b4dfa3c5-2b18-4d7a-88f8-b660b8f625f3" /># FaceRecognition
Итоговый проект DLS МФТИ весеннего семестра часть 1
По всем вопросам обращаться в тг: @odronium

## Краткое описание файлов
**1_FaceAlignment.ipynb** - Вторая часть пайплайна, руализующая нахождение опорных точек и выравнивание
**predictions.png** - Пример предикта опорных точек
**2_CE_loss.ipynb** - Третья часть пайплайна с СЕ loss
**2_2_ArcFace_loss.ipynb** - Третья часть пайплайна с ArcFace loss
**list_landmarks_align_celeba** - landmarks
**identity_CelebA3.txt** - identity под обрезанный датасет (Третья часть пайплайна)
**hend.pth** - Веса для второй части пайплайна
**best_ARC_face_resnet50VBEST** - Веса для ArcFace loss 
**best_resnet50VBEST** - Веса для СЕ loss
Последняя пара весов в zip лежит на гугл диске (много весят, даже в зипке): https://drive.google.com/file/d/1BkHrRLJZk5m_CKXJbH1iRhNFqMULP6tU/view?usp=sharing

## Мысли по поводу проделанной работы
### Вторая часть пайлайна
Самым сложным в работе оказалось поймать баланс между сложностью сети и ее требованиям к ресурсам. В итоге получилось так, что требовалось порядка 15гб для обучения, использовал Google Collab. Также возникли проблемы с гомографией, она работала достаточно неадекватно, взял афинное преобразование с тремя точками (глаза и нос). Пример предикта опорных точек предоставил отдельно, тк он лежал на коллабе. 
### Третья часть пайлайна
Тут трудности возникли с выбором гиперпараметров и подготовкой датасета. Изначально не верилось, что на случайной выборке совсем ничего не сможет обучиться.... В итоге были выбраны первых 20000 картинок с людьми, у которых макс. кол-во картинок. Из интересных решение в Arc и CE был использован TTA (test-time augmentation), который использует аугментацию во время валидации, это помогло добить мне пару процентов на val_acc. Итоговые результаты 70.98% на Arc и 71.74% на CE лоссах. Конечно странно, что второй получился лучше и, если честно, легче, но в Arc мне было намного менее интуитивно, что лучший результат получился при s=45.0, m=0.1. Такое значение m мне казалось слишком маленьким (отходя от стандартных 0.3), но оказалось оправдано. Обучалось что-то порядка 80 эпох, что первое, что второе. Графики не сохранились, тк часто перебирал параметры, замораживал веса, убирал/добавлял аугментации. 
### Пайплайн
Пайплайн неплохо справляется с задачей, довольно неплохо отличает лица, пример в ноутбуке.
